<!--[*  $Id: news_user_categorylist.htm 75 2009-02-24 04:51:52Z mateo $  *]-->

<!--[include file='news_user_menu.htm']-->

<!--[if $enablecategorization]-->
  <div class="pn-frontendcontainer">
  <!--[* assign page title *]-->
  <!--[gt text="Available Categories" assign='NewsCatTitle']-->
  <!--[pnpagesetvar name='title' value=$NewsCatTitle]-->
  <h2><!--[gt text="Available Categories"]--></h2>
  <!--[foreach from=$propertiesdata item='property']-->
    <!--[if $propertiesdata|@count gt 1]-->
        <h3><!--[$property.name]--><!--[if $property.category.news_totalarticlecount gt 0]--> (<!--[gt text="1 article" plural="%s articles" count=$property.category.news_totalarticlecount]-->)<!--[else]-->(<!--[gt text="no articles"]-->)<!--[/if]--></h3>
    <!--[/if]-->
    <!--[assign var='category' value=`$property.category`]-->
    <ul>
      <!--[foreach from=$category.subcategories item='category']-->
        <!--[* get the category name and description avoiding E_ALL errors *]-->
        <!--[array_field_isset assign='categoryname' array=$category.display_name field=$language returnValue=1]-->
        <!--[if $categoryname eq '']--><!--[assign var='categoryname' value=$category.name]--><!--[/if]-->
        <!--[array_field_isset assign='categorydesc' array=$category.display_desc field=$language returnValue=1]-->
        <!--[assign var='categoryid' value=$category.id]-->
        <!--[securityutil_checkpermission component='Categories::category' instance="ID::$category.id" level='ACCESS_EDIT' assign='authcatedit']-->
        <li>
        <!--[if $shorturls and $shorturlstype eq 0]-->
          <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$category.path|replace:$property.rootcat.path:'']-->" title="<!--[$categorydesc]-->"><!--[$categoryname]--></a>
        <!--[else]-->
          <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$category.id]-->" title="<!--[$categorydesc]-->"><!--[$categoryname]--></a>
        <!--[/if]-->
        <!--[if $authcatedit]-->
          <a href="<!--[pnmodurl modname='Categories' type='admin' func='edit' mode='edit' cid=$category.id]-->"><!--[pnimg modname='core' set='icons/extrasmall' src='xedit.gif' __alt='Edit']--></a>
        <!--[/if]-->

		&nbsp;&nbsp;<span class="pn-sub">
        <!--[nocache]-->
        <!--[if $shorturls and $shorturlstype eq 0]-->
          <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$category.path|replace:$property.rootcat.path:'' theme='rss']-->"><!--[pnimg modname='core' set='feeds' src='feed-icon-12x12.png' __alt='RSS Feed']--></a>
        <!--[else]-->
          <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$category.id theme='rss']-->"><!--[pnimg modname='core' set='feeds' src='feed-icon-12x12.png' __alt='RSS Feed']--></a>
        <!--[/if]-->

        <!--[if $category.category.news_totalarticlecount gt 0]-->
            <!--[gt text="1 article" plural="%s articles" count=$category.category.news_articlecount]-->
            <!--[if $category.category.news_totalarticlecount gt $category.category.news_articlecount]-->| <!--[gt text="%n in total" tag1=$category.category.news_totalarticlecount]--><!--[/if]-->
            <!--[if $category.category.news_yourarticlecount gt 0]-->| <!--[gt text="%n self-written" tag1=$category.category.news_yourarticlecount]--><!--[/if]-->
        <!--[else]-->
            <!--[gt text="no articles"]-->
        <!--[/if]-->
        <!--[/nocache]-->
		</span>
        
        <!--[* Second level category display *]-->
        <!--[if !empty($category.subcategories)]-->
        <ul style="margin-bottom:0">
        <!--[foreach from=$category.subcategories item='subcat']-->
            <!--[array_field_isset assign='categoryname' array=$subcat.display_name field=$language returnValue=1]-->
            <!--[if $categoryname eq '']--><!--[assign var='categoryname' value=$subcat.name]--><!--[/if]-->
            <!--[array_field_isset assign='categorydesc' array=$subcat.display_desc field=$language returnValue=1]-->
            <!--[assign var='categoryid' value=$subcat.id]-->
            <!--[securityutil_checkpermission component='Categories::category' instance="ID::$subcat.id" level='ACCESS_EDIT' assign='authcatedit']-->
            <li>
            <!--[if $shorturls and $shorturlstype eq 0]-->
              <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$subcat.path|replace:$property.rootcat.path:'']-->" title="<!--[$categorydesc]-->"><!--[$categoryname]--></a>
            <!--[else]-->
              <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$subcat.id]-->" title="<!--[$categorydesc]-->"><!--[$categoryname]--></a>
            <!--[/if]-->
            <!--[if $authcatedit]-->
              <a href="<!--[pnmodurl modname='Categories' type='admin' func='edit' mode='edit' cid=$subcat.id]-->"><!--[pnimg modname='core' set='icons/extrasmall' src='xedit.gif' __alt='Edit']--></a>
            <!--[/if]-->

            &nbsp;&nbsp;<span class="pn-sub">
            <!--[nocache]-->
            <!--[if $shorturls and $shorturlstype eq 0]-->
              <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$subcat.path|replace:$property.rootcat.path:'' theme='rss']-->"><!--[pnimg modname='core' set='feeds' src='feed-icon-12x12.png' __alt='RSS Feed']--></a>
            <!--[else]-->
              <a href="<!--[pnmodurl modname='News' type='user' func='view' prop=$property.name cat=$subcat.id theme='rss']-->"><!--[pnimg modname='core' set='feeds' src='feed-icon-12x12.png' __alt='RSS Feed']--></a>
            <!--[/if]-->
     
            <!--[if $subcat.category.news_totalarticlecount gt 0]-->
                <!--[gt text="1 article" plural="%s articles" count=$subcat.category.news_articlecount]-->
                <!--[if $subcat.category.news_totalarticlecount gt $subcat.category.news_articlecount]-->| <!--[gt text="%n in total" tag1=$subcat.category.news_totalarticlecount]--><!--[/if]-->
                <!--[if $subcat.category.news_yourarticlecount gt 0]-->| <!--[gt text="%n self-written" tag1=$subcat.category.news_yourarticlecount]--><!--[/if]-->
            <!--[else]-->
                <!--[gt text="no articles"]-->
            <!--[/if]-->
            <!--[/nocache]-->
            </span>
            </li>
        <!--[/foreach]-->
        </ul>
        <!--[/if]-->
        <!--[* End of second level subcategories *]-->
        
        </li>
      <!--[/foreach]-->
    </ul>
  <!--[/foreach]-->
  </div>
<!--[else]-->
  <!--[pnmodfunc modname='News' type='user' func='main']-->
<!--[/if]-->
